<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>shinoefuhi Official Website</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@300;600&family=Montserrat:wght@300;600&display=swap" rel="stylesheet">
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <style>
        :root { --bg-color: #f8fafd; --accent-yellow: #fdfd96; --main-text: #2c3e50; --sub-text: #7f8c8d; }
        html { scroll-behavior: smooth; }
        body { margin: 0; background-color: var(--bg-color); color: var(--main-text); font-family: 'Noto Serif JP', serif; line-height: 1.8; opacity: 0; animation: pageFadeIn 1.5s ease-out forwards; }
        @keyframes pageFadeIn { to { opacity: 1; } }
        a { text-decoration: none; color: inherit; transition: 0.3s; }
        header { height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; background: linear-gradient(rgba(248,250,253,0.8), rgba(248,250,253,0.8)), url('artist-photo.jpg') center/cover; }
        h1 { font-family: 'Montserrat', sans-serif; font-size: 3rem; letter-spacing: 0.5rem; margin-bottom: 1rem; font-weight: 300; }
        section { padding: 100px 10%; max-width: 1200px; margin: 0 auto; text-align: center; }
        h2 { font-family: 'Montserrat', sans-serif; font-size: 2rem; letter-spacing: 0.3rem; margin-bottom: 50px; position: relative; display: inline-block; }
        h2::after { content: ''; position: absolute; bottom: -10px; left: 50%; transform: translateX(-50%); width: 30px; height: 1px; background: var(--main-text); }
        
        /* ライブ情報のリスト用スタイル */
        .live-item { margin-bottom: 40px; text-align: left; padding: 20px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; }
        .live-date { font-family: 'Montserrat', sans-serif; font-size: 1.2rem; color: var(--sub-text); margin-right: 30px; }
        .live-info { flex-grow: 1; }
        .live-title { font-weight: 600; font-size: 1.1rem; }
        .ticket-btn { padding: 5px 20px; border: 1px solid var(--main-text); font-size: 0.8rem; letter-spacing: 0.1rem; }
        .ticket-btn:hover { background: var(--main-text); color: #fff; }

        /* 作品情報（Discography）用スタイル */
        .disc-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 40px; margin-top: 50px; }
        .disc-item { background: #fff; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .disc-item img { width: 100%; aspect-ratio: 1/1; object-fit: cover; margin-bottom: 15px; }
        .streaming-links { font-size: 1.4rem; display: flex; justify-content: center; gap: 20px; margin: 15px 0; }
        .streaming-links a:hover { color: var(--sub-text); }
        .cd-details { font-size: 0.85rem; text-align: left; border-top: 1px solid #eee; padding-top: 15px; margin-top: 15px; }
    </style>
</head>
<body>

<header>
    <h1>shinoefuhi</h1>
    <nav>
        <a href="#live">LIVE</a> / <a href="#discography">DISCOGRAPHY</a> / <a href="#contact">CONTACT</a>
    </nav>
</header>

<section id="live">
    <h2>LIVE</h2>
    <div id="live-list">読み込み中...</div>
</section>

<section id="discography">
    <h2>DISCOGRAPHY</h2>
    <div id="disc-list" class="disc-grid">読み込み中...</div>
</section>

<script>
<script>
    // 1. LIVE情報の取得（ダッシュボードで入力したデータを読み込む）
    const liveList = document.getElementById('live-list');
    fetch('https://api.github.com/repos/shinoefuhi/shinoefuhi-site/contents/_data/lives')
        .then(res => res.json())
        .then(files => {
            liveList.innerHTML = ''; 
            const today = new Date().toISOString().split('T')[0];

            files.forEach(file => {
                fetch(file.download_url).then(r => r.text()).then(yaml => {
                    const date = yaml.match(/date: "(.+)"/)?.[1] || "";
                    const title = yamlText.match(/title: "(.+)"/)?.[1] || "";
                    const place = yaml.match(/place: "(.+)"/)?.[1] || "";
                    const time = yaml.match(/time: "(.+)"/)?.[1] || "";
                    const flyer = yaml.match(/flyer: "(.+)"/)?.[1] || "";
                    const url = yaml.match(/ticketUrl: "(.+)"/)?.[1] || "";

                    if (date >= today) {
                        liveList.innerHTML += `
                            <div class="live-item">
                                <div class="live-date">${date.replace(/-/g, '.')} <br><span style="font-size:0.8em; font-weight:normal;">${time}</span></div>
                                <div class="live-info">
                                    <span class="live-title">${title}</span>
                                    <span class="live-place">@ ${place}</span>
                                </div>
                                <div class="live-actions">
                                    ${flyer ? `<button class="btn btn-flyer" onclick="openModal('${flyer}')">FLYER</button>` : ''}
                                    ${url ? `<a href="${url}" target="_blank" class="btn">TICKET</a>` : ''}
                                </div>
                            </div>`;
                    }
                });
            });
        }).catch(() => { liveList.innerHTML = '<p>現在、ライブの予定はありません。</p>'; });

    // 2. DISCOGRAPHYの取得（ダッシュボードで入力したデータを読み込む）
    const discGrid = document.querySelector('.disc-grid');
    fetch('https://api.github.com/repos/shinoefuhi/shinoefuhi-site/contents/_data/discography')
        .then(res => res.json())
        .then(files => {
            discGrid.innerHTML = '';
            files.forEach(file => {
                fetch(file.download_url).then(r => r.text()).then(yaml => {
                    const title = yaml.match(/title: "(.+)"/)?.[1] || "";
                    const img = yaml.match(/image: "(.+)"/)?.[1] || "";
                    const type = yaml.match(/type: "(.+)"/)?.[1] || "";
                    const apple = yaml.match(/appleMusic: "(.+)"/)?.[1] || "";

                    discGrid.innerHTML += `
                        <div class="disc-item">
                            <img src="${img}" alt="${title}">
                            <h3>${title}</h3>
                            <p style="font-size: 0.9rem; color: var(--sub-text);">${type}</p>
                            <div style="margin-top: 15px;">
                                ${apple ? `<a href="${apple}" target="_blank" class="btn">LISTEN</a>` : ''}
                            </div>
                        </div>`;
                });
            });
        });

    // モーダル・パララックス制御
    function openModal(imgSrc) {
        document.getElementById('modalImg').src = imgSrc;
        document.getElementById('flyerModal').style.display = "flex";
    }
    function closeModal() { document.getElementById('flyerModal').style.display = "none"; }
    window.onclick = function(e) { if (e.target == document.getElementById('flyerModal')) closeModal(); }
    window.addEventListener('scroll', () => {
        const bg = document.getElementById('hero-bg');
        if(bg) bg.style.transform = `translateY(${window.pageYOffset * 0.4}px) scale(1.05)`;
    });
</script>
</script>

</body>
</html>
